{"ast":null,"code":"import { FormGroup, FormControl, Validators } from '@angular/forms';\nimport { BehaviorSubject } from 'rxjs';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../../service/message.service\";\nimport * as i2 from \"@angular/common\";\nimport * as i3 from \"@angular/forms\";\nconst _c0 = [\"scrollMe\"];\nfunction HelpSupportComponent_div_13_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 16)(1, \"div\");\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const message_r5 = ctx.$implicit;\n    i0.ɵɵadvance(1);\n    i0.ɵɵclassMap(message_r5.type);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", message_r5.message, \" \");\n  }\n}\nfunction HelpSupportComponent_div_15_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 17)(1, \"div\");\n    i0.ɵɵtext(2, \"...\");\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    i0.ɵɵadvance(1);\n    i0.ɵɵclassMap(\"client\");\n  }\n}\nfunction HelpSupportComponent_div_16_div_3_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r9 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\")(1, \"button\", 20);\n    i0.ɵɵlistener(\"click\", function HelpSupportComponent_div_16_div_3_Template_button_click_1_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r9);\n      const question_r7 = restoredCtx.$implicit;\n      const ctx_r8 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r8.populateInput(question_r7.questions));\n    });\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const question_r7 = ctx.$implicit;\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(question_r7.questions);\n  }\n}\nfunction HelpSupportComponent_div_16_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r11 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 7)(1, \"button\", 18);\n    i0.ɵɵlistener(\"click\", function HelpSupportComponent_div_16_Template_button_click_1_listener() {\n      i0.ɵɵrestoreView(_r11);\n      const ctx_r10 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r10.askMoreQuestions());\n    });\n    i0.ɵɵtext(2, \"\\u2753 Ask more\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(3, HelpSupportComponent_div_16_div_3_Template, 3, 1, \"div\", 19);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r3 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(3);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r3.generatedQuestions.slice(0, 4));\n  }\n}\nfunction HelpSupportComponent_div_17_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 16)(1, \"div\");\n    i0.ɵɵtext(2, \"Want to ask something else! Type your question below \\u2B07\");\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    i0.ɵɵadvance(1);\n    i0.ɵɵclassMap(\"client\");\n  }\n}\nexport class HelpSupportComponent {\n  constructor(messageService) {\n    this.messageService = messageService;\n    this.isOpen = false;\n    this.loading = false;\n    this.messages = [];\n    this.state = 'botType'; // Initial state set to 'botType'\n    this.messages$ = new BehaviorSubject([]);\n    this.chatForm = new FormGroup({\n      message: new FormControl('', [Validators.required])\n    });\n    this.generatedQuestions = [];\n    this.messages.push({\n      type: 'client',\n      message: 'Hi, I am your support agent. How can I help you?'\n    });\n  }\n  openSupportPopup() {\n    this.isOpen = !this.isOpen;\n  }\n  sendMessage() {\n    const sentMessage = this.chatForm.value.message;\n    console.log('sentMessage=' + sentMessage);\n    this.loading = true;\n    this.messages.push({\n      type: 'user',\n      message: sentMessage\n    });\n    this.messages$.next(this.messages$.getValue().concat([{\n      type: 'user',\n      message: sentMessage\n    }]));\n    this.chatForm.reset();\n    this.scrollToBottom();\n    this.messageService.sendMessage(sentMessage).subscribe(response => {\n      this.loading = false;\n      this.state = 'generatedQuestions'; // Set state to 'generatedQuestions' after getting response\n      this.lastReceivedAnswer = response.answer;\n      this.messages.push({\n        type: 'client',\n        message: this.lastReceivedAnswer\n      });\n      this.messages$.next(this.messages$.getValue().concat([{\n        type: 'client',\n        message: this.lastReceivedAnswer\n      }]));\n      console.log('response.answer:', this.lastReceivedAnswer);\n      this.scrollToBottom();\n    });\n  }\n  askMoreQuestions() {\n    this.state = 'generatedQuestions';\n    this.generatedQuestions = [];\n    if (this.lastReceivedAnswer) {\n      this.messageService.questionGeneration(this.lastReceivedAnswer).subscribe(qResponse => {\n        console.log('this.generatedQuestions:', qResponse.related_questions.generated_questions);\n        const questionsObj = qResponse.related_questions.generated_questions;\n        console.log('questionsObj:', questionsObj);\n        if (questionsObj) {\n          const questions = questionsObj[0].questions;\n          console.log('questions=' + questions);\n          questions.slice(0, 4).forEach(question => {\n            this.generatedQuestions.push({\n              questions: question\n            });\n          });\n        }\n        console.log('this.questions:', this.generatedQuestions);\n        console.log('this.messages:', this.messages);\n      });\n    }\n  }\n  populateInput(question) {\n    this.chatForm.get('message').setValue(question);\n    this.sendMessage();\n    this.state = 'botType'; // Set state to 'botType' after bot responds to the selected question\n  }\n\n  scrollToBottom() {\n    setTimeout(() => {\n      try {\n        this.myScrollContainer.nativeElement.scrollTop = this.myScrollContainer.nativeElement.scrollHeight + 500;\n      } catch (err) {}\n    }, 150);\n  }\n}\nHelpSupportComponent.ɵfac = function HelpSupportComponent_Factory(t) {\n  return new (t || HelpSupportComponent)(i0.ɵɵdirectiveInject(i1.MessageService));\n};\nHelpSupportComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: HelpSupportComponent,\n  selectors: [[\"app-help-support\"]],\n  viewQuery: function HelpSupportComponent_Query(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵviewQuery(_c0, 5);\n    }\n    if (rf & 2) {\n      let _t;\n      i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.myScrollContainer = _t.first);\n    }\n  },\n  decls: 22,\n  vars: 10,\n  consts: [[\"id\", \"helpdesk\"], [\"id\", \"helpdesk-popup-button\", 3, \"click\"], [\"id\", \"helpdesk-popup\"], [\"id\", \"helpdesk-popup-header\"], [\"src\", \"data:image/png;base64,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\", \"alt\", \"alternative text\"], [\"id\", \"helpdesk-popup-close-button\", 3, \"click\"], [\"id\", \"helpdesk-popup-body\"], [1, \"messages\"], [\"scrollMe\", \"\"], [\"class\", \"message\", 4, \"ngFor\", \"ngForOf\"], [\"class\", \"message\", \"style\", \"width: 100%; display: block\", 4, \"ngIf\"], [\"class\", \"messages\", 4, \"ngIf\"], [\"class\", \"message\", 4, \"ngIf\"], [\"id\", \"helpdesk-popup-footer\", 3, \"formGroup\"], [\"formControlName\", \"message\", \"type\", \"text\", \"id\", \"helpdesk-popup-input\", \"placeholder\", \"Type your message here...\"], [\"id\", \"helpdesk-popup-submit-button\", 3, \"disabled\", \"click\"], [1, \"message\"], [1, \"message\", 2, \"width\", \"100%\", \"display\", \"block\"], [1, \"ask-more-button\", 3, \"click\"], [4, \"ngFor\", \"ngForOf\"], [1, \"generate-questions\", 3, \"click\"]],\n  template: function HelpSupportComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵelementStart(0, \"div\", 0)(1, \"button\", 1);\n      i0.ɵɵlistener(\"click\", function HelpSupportComponent_Template_button_click_1_listener() {\n        return ctx.openSupportPopup();\n      });\n      i0.ɵɵtext(2, \" Need Help? \");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(3, \"div\", 2)(4, \"div\", 3)(5, \"div\");\n      i0.ɵɵelement(6, \"img\", 4);\n      i0.ɵɵelementEnd();\n      i0.ɵɵtext(7, \" Chatbot Support! \");\n      i0.ɵɵelementStart(8, \"button\", 5);\n      i0.ɵɵlistener(\"click\", function HelpSupportComponent_Template_button_click_8_listener() {\n        return ctx.openSupportPopup();\n      });\n      i0.ɵɵtext(9, \" Close \");\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(10, \"div\", 6)(11, \"div\", 7, 8);\n      i0.ɵɵtemplate(13, HelpSupportComponent_div_13_Template, 3, 3, \"div\", 9);\n      i0.ɵɵpipe(14, \"async\");\n      i0.ɵɵtemplate(15, HelpSupportComponent_div_15_Template, 3, 2, \"div\", 10);\n      i0.ɵɵtemplate(16, HelpSupportComponent_div_16_Template, 4, 1, \"div\", 11);\n      i0.ɵɵtemplate(17, HelpSupportComponent_div_17_Template, 3, 2, \"div\", 12);\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(18, \"form\", 13);\n      i0.ɵɵelement(19, \"input\", 14);\n      i0.ɵɵelementStart(20, \"button\", 15);\n      i0.ɵɵlistener(\"click\", function HelpSupportComponent_Template_button_click_20_listener() {\n        return ctx.sendMessage();\n      });\n      i0.ɵɵtext(21, \" Send \");\n      i0.ɵɵelementEnd()()()();\n    }\n    if (rf & 2) {\n      i0.ɵɵadvance(3);\n      i0.ɵɵstyleProp(\"display\", ctx.isOpen ? \"block\" : \"none\");\n      i0.ɵɵadvance(10);\n      i0.ɵɵproperty(\"ngForOf\", i0.ɵɵpipeBind1(14, 8, ctx.messages$));\n      i0.ɵɵadvance(2);\n      i0.ɵɵproperty(\"ngIf\", ctx.loading);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"ngIf\", ctx.state === \"generatedQuestions\");\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"ngIf\", ctx.state === \"generatedQuestions\");\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"formGroup\", ctx.chatForm);\n      i0.ɵɵadvance(2);\n      i0.ɵɵproperty(\"disabled\", !ctx.chatForm.valid);\n    }\n  },\n  dependencies: [i2.NgForOf, i2.NgIf, i3.ɵNgNoValidate, i3.DefaultValueAccessor, i3.NgControlStatus, i3.NgControlStatusGroup, i3.FormGroupDirective, i3.FormControlName, i2.AsyncPipe],\n  styles: [\"var[_ngcontent-%COMP%]   resource[_ngcontent-%COMP%];\\n (()[_ngcontent-%COMP%]   =[_ngcontent-%COMP%] >  { // webpackBootstrap\\n \\tvar __webpack_modules__ = ({\\n\\n 672:\\n\\n (() => {\\n\\nthrow new Error(\\\"Module build failed (from ./node_modules/sass-loader/dist/cjs.js):\\\\nSassError: unmatched \\\\\\\"}\\\\\\\".\\\\n    \\u2577\\\\n164 \\u2502 }\\\\n    \\u2502 ^\\\\n    \\u2575\\\\n  src/app/shared/components/help-support/help-support.component.scss 164:1  root stylesheet\\\");\\n\\n })\\n\\n \\t})[_ngcontent-%COMP%];\\n\\n \\t\\n \\t//[_ngcontent-%COMP%]   startup[_ngcontent-%COMP%]   //[_ngcontent-%COMP%]   Load[_ngcontent-%COMP%]   entry[_ngcontent-%COMP%]   module[_ngcontent-%COMP%]   and[_ngcontent-%COMP%]   return[_ngcontent-%COMP%]   exports[_ngcontent-%COMP%]   //[_ngcontent-%COMP%]   This[_ngcontent-%COMP%]   entry[_ngcontent-%COMP%]   module[_ngcontent-%COMP%]   doesn't[_ngcontent-%COMP%]   tell[_ngcontent-%COMP%]   about[_ngcontent-%COMP%]   it's[_ngcontent-%COMP%]   top-level[_ngcontent-%COMP%]   declarations[_ngcontent-%COMP%]   so[_ngcontent-%COMP%]   it[_ngcontent-%COMP%]   can't[_ngcontent-%COMP%]   be[_ngcontent-%COMP%]   inlined[_ngcontent-%COMP%]   var[_ngcontent-%COMP%]   __webpack_exports__[_ngcontent-%COMP%]   =[_ngcontent-%COMP%] {};\\n \\t__webpack_modules__[672]();\\n \\tresource = __webpack_exports__;\\n \\t\\n })()\\n;\"]\n});","map":{"version":3,"mappings":"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","names":["FormGroup","FormControl","Validators","BehaviorSubject","i0","HelpSupportComponent","constructor","messageService","message","required","messages","push","type","openSupportPopup","isOpen","sendMessage","sentMessage","chatForm","value","console","log","loading","messages$","next","getValue","concat","reset","scrollToBottom","subscribe","response","state","lastReceivedAnswer","answer","askMoreQuestions","generatedQuestions","questionGeneration","qResponse","related_questions","generated_questions","questionsObj","questions","slice","forEach","question","populateInput","get","setValue","setTimeout","myScrollContainer","nativeElement","scrollTop","scrollHeight","err","selectors","viewQuery","ctx"],"sourceRoot":"","sources":["/Users/I570594/Documents/Angular-Chatbot/chatbot/src/app/shared/components/help-support/help-support.component.ts","/Users/I570594/Documents/Angular-Chatbot/chatbot/src/app/shared/components/help-support/help-support.component.html"],"sourcesContent":["import { Component, ViewChild } from '@angular/core';\nimport { FormGroup, FormControl, Validators } from '@angular/forms';\nimport { MessageService } from '../../service/message.service';\nimport { BehaviorSubject } from 'rxjs';\n\nexport interface Message {\n  type: string;\n  message: string;\n}\n\nexport interface GeneratedQuestion {\n  questions: string;\n}\n\n@Component({\n  selector: 'app-help-support',\n  templateUrl: './help-support.component.html',\n  styleUrls: ['./help-support.component.scss'],\n})\nexport class HelpSupportComponent {\n  isOpen = false;\n  loading = false;\n  messages: Message[] = [];\n  state: 'userType' | 'botType' | 'generatedQuestions' = 'botType'; // Initial state set to 'botType'\n  messages$ = new BehaviorSubject<Array<{ type: string, message: string }>>([]);\n  chatForm = new FormGroup({\n    message: new FormControl('', [Validators.required]),\n  });\n  @ViewChild('scrollMe') private myScrollContainer: any;\n  generatedQuestions: GeneratedQuestion[] = [];\n  lastReceivedAnswer: any;\n\n  constructor(private messageService: MessageService) {\n    this.messages.push({\n      type: 'client',\n      message: 'Hi, I am your support agent. How can I help you?',\n    });\n  }\n\n  openSupportPopup() {\n    this.isOpen = !this.isOpen;\n  }\n\n  sendMessage() {\n    const sentMessage = this.chatForm.value.message!;\n    console.log('sentMessage=' + sentMessage);\n    this.loading = true;\n    this.messages.push({\n      type: 'user',\n      message: sentMessage,\n    });\n    this.messages$.next(this.messages$.getValue().concat([{ type: 'user', message: sentMessage }]));\n    this.chatForm.reset();\n    this.scrollToBottom();\n\n    this.messageService.sendMessage(sentMessage).subscribe((response: any) => {\n      this.loading = false;\n      this.state = 'generatedQuestions'; // Set state to 'generatedQuestions' after getting response\n      this.lastReceivedAnswer = response.answer;\n      this.messages.push({\n        type: 'client',\n        message: this.lastReceivedAnswer,\n      });\n      this.messages$.next(this.messages$.getValue().concat([{ type: 'client', message: this.lastReceivedAnswer }]));\n      console.log('response.answer:', this.lastReceivedAnswer);\n      this.scrollToBottom();\n    });\n  }\n\n  askMoreQuestions() {\n    this.state = 'generatedQuestions';\n    this.generatedQuestions = [];\n    if(this.lastReceivedAnswer) {\n      this.messageService.questionGeneration(this.lastReceivedAnswer).subscribe((qResponse: any) => {\n        console.log('this.generatedQuestions:', qResponse.related_questions.generated_questions);\n        const questionsObj = qResponse.related_questions.generated_questions;\n        console.log('questionsObj:', questionsObj);\n        if (questionsObj) {\n          const questions = questionsObj[0].questions;\n          console.log('questions=' + questions);\n          questions.slice(0, 4).forEach((question: string) => {\n            this.generatedQuestions.push({\n              questions: question,\n            });\n          });\n        }\n        console.log('this.questions:', this.generatedQuestions);\n        console.log('this.messages:', this.messages);\n      });\n    }\n  }\n\n  populateInput(question: string) {\n    this.chatForm.get('message')!.setValue(question);\n    this.sendMessage();\n    this.state = 'botType'; // Set state to 'botType' after bot responds to the selected question\n  }\n\n  scrollToBottom() {\n    setTimeout(() => {\n      try {\n        this.myScrollContainer.nativeElement.scrollTop = this.myScrollContainer.nativeElement.scrollHeight + 500;\n      } catch (err) {}\n    }, 150);\n  }\n}\n","<div id=\"helpdesk\">\n  <button id=\"helpdesk-popup-button\" (click)=\"openSupportPopup()\">\n    Need Help?\n  </button>\n  <div id=\"helpdesk-popup\" [style.display]=\"isOpen ? 'block' : 'none'\">\n    <div id=\"helpdesk-popup-header\">\n      <div><img src=\"data:image/png;base64,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\" alt=\"alternative text\">\n      </div>\n      Chatbot Support!\n      <button id=\"helpdesk-popup-close-button\" (click)=\"openSupportPopup()\">\n        Close\n      </button>\n    </div>\n    <div id=\"helpdesk-popup-body\">\n      <div class=\"messages\" #scrollMe>\n        <div *ngFor=\"let message of messages$ | async\" class=\"message\">\n          <div [class]=\"message.type\">\n            {{ message.message }}\n          </div>\n        </div>\n        <div *ngIf=\"loading\" class=\"message\" style=\"width: 100%; display: block\">\n          <div [class]=\"'client'\">...</div>\n        </div>\n        <div class=\"messages\" *ngIf=\"state === 'generatedQuestions'\">\n          <button class=\"ask-more-button\" (click)=\"askMoreQuestions()\">❓ Ask more</button>\n          <div *ngFor=\"let question of generatedQuestions.slice(0, 4)\">\n            <button class=\"generate-questions\" (click)=\"populateInput(question.questions)\">{{ question.questions }}</button>\n          </div>\n        </div>\n        <div class=\"message\" *ngIf=\"state === 'generatedQuestions'\">\n          <div [class]=\"'client'\">Want to ask something else! Type your question below ⬇</div>\n        </div>        \n      </div>\n    </div>\n    <form id=\"helpdesk-popup-footer\" [formGroup]=\"chatForm\">\n      <input\n        formControlName=\"message\"\n        type=\"text\"\n        id=\"helpdesk-popup-input\"\n        placeholder=\"Type your message here...\"\n      />\n      <button\n        id=\"helpdesk-popup-submit-button\"\n        [disabled]=\"!chatForm.valid\"\n        (click)=\"sendMessage()\"\n      >\n        Send\n      </button>\n    </form>\n  </div>\n</div>\n"]},"metadata":{},"sourceType":"module","externalDependencies":[]}